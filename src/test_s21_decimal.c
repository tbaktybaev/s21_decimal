#include <check.h>
#include <float.h>
#include <limits.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

#include "s21_decimal.h"

int s21_decimal_to_str(const s21_decimal *number, char *str) {
  size_t bits = S21_DECIMAL_SIZE * 32;
  str[bits] = '\0';
  for (size_t str_idx = 0, bit = bits - 1; str_idx < bits; ++str_idx, --bit)
    str[str_idx] = s21_check_decimal_bit(number, bit) ? '1' : '0';
  return 0;
}

START_TEST(test_s21_add) {
  printf("test_s21_add\n");
  s21_decimal dec_num_1[] = {
      {{10, 0, 0, 0}},
      {{10, 0, 0, 0x80000000}},
      {{0, 0, 0xffffffff, 0}},
      {{0, 0, 0xffffffff, 0}},
      {{0, 0, 0xffffffff, 0}},
      {{1, 0, 0xffffffff, 0}},
      {{1, 0, 0xffffffff, 0}},
      {{1, 0, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x80000000}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0x80000000}},
      {{8, 0, 0, 0}},
      {{123456, 0, 0, 0x80050000}},
      {{100, 0, 0, 0x80000000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x30000}},
  };

  s21_decimal dec_num_2[] = {
      {{3, 0, 0, 0x10000}},     {{3, 0, 0, 0x80010000}},
      {{6, 0, 0, 0x10000}},     {{5, 0, 0, 0x10000}},
      {{4, 0, 0, 0x10000}},     {{6, 0, 0, 0x10000}},
      {{5, 0, 0, 0x10000}},     {{4, 0, 0, 0x10000}},
      {{16, 0, 0, 0x10000}},    {{16, 0, 0, 0x80010000}},
      {{16, 0, 0, 0x10000}},    {{16, 0, 0, 0x80010000}},
      {{20, 0, 0, 0x80010000}}, {{1, 0, 0, 0}},
      {{100, 0, 0, 0}},         {{1, 0, 0, 0x30000}},
  };

  s21_decimal dec_res = {{0, 0, 0, 0}};

  char *dec_str_ans[] = {
      "000000000000000100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000001100111",
      "100000000000000100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000001100111",
      "000000000000000000000000000000001111111111111111111111111111111100000000"
      "00000000000000000000000000000000000000000000000000000001",
      "000000000000000000000000000000001111111111111111111111111111111100000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000001111111111111111111111111111111100000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000001111111111111111111111111111111100000000"
      "00000000000000000000000000000000000000000000000000000010",
      "000000000000000000000000000000001111111111111111111111111111111100000000"
      "00000000000000000000000000000000000000000000000000000010",
      "000000000000000000000000000000001111111111111111111111111111111100000000"
      "00000000000000000000000000000000000000000000000000000001",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000111100",
      "100000000000010100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000101101110100000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000001000000000000000000001100110011001100110011001100110011001"
      "10011001100110011001100110011001100110011001100110011010",
  };

  int results[] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 2, 0, 0, 0, 0};
  for (size_t i = 0; i < 16; ++i) {
    int result = s21_add(dec_num_1[i], dec_num_2[i], &dec_res);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_res, dec_str);
    printf("%d | %d\n", results[i], result);
    ck_assert_str_eq(dec_str, dec_str_ans[i]);
    ck_assert_int_eq(result, results[i]);
  }
  ck_assert_int_eq(s21_add(dec_num_1[0], dec_num_2[0], NULL), 4);
}
END_TEST

START_TEST(test_s21_set_exp_and_s21_get_exp) {
  printf("test_s21_set_exp_and_s21_get_exp\n");
  s21_decimal dec_num[] = {{{2, 3, 4, 0x800C0000}}, {{2, 3, 4, 0x000C0000}}};
  int int_num[] = {3, 0, 28, 29, -1, INT_MAX, INT_MIN};
  for (size_t j = 0; j < 2; ++j) {
    for (size_t i = 0; i < 7; ++i) {
      unsigned sign = s21_checkbit(dec_num[j].bits[3], 31);
      int result = s21_set_exp(&dec_num[j], int_num[i]);
      unsigned exp = s21_get_exp(&dec_num[j]);
      printf("%12d | %2u | %d\n", int_num[i], exp, result);
      if (!result) ck_assert_uint_eq(int_num[i], exp);
      ck_assert_int_eq(result, int_num[i] >= 0 && int_num[i] < 29 ? 0 : 1);
      ck_assert_uint_eq(s21_checkbit(dec_num[j].bits[3], 31), sign);
    }
  }
  ck_assert_int_eq(s21_set_exp(NULL, 456), 1);
  ck_assert_int_eq(s21_set_exp(NULL, 2), 1);
}
END_TEST

START_TEST(test_count_significant_bits) {
  printf("test_count_significant_bits\n Вывод | Должно быть\n");
  s21_decimal dec_num[] = {{{0, 0, 0, 0}},          {{1, 0, 0, 0}},
                           {{0, 3, 0, 0}},          {{456, 0, 7, 0}},
                           {{0xFFFFFFFF, 0, 0, 0}}, {{0, 0xFFFFFFFF, 0, 0}},
                           {{0, 0, 0xFFFFFFFF, 0}}};
  unsigned result[] = {0, 1, 34, 67, 32, 64, 96};
  for (size_t i = 0; i < 7; ++i) {
    unsigned count = s21_count_significant_bits(&dec_num[i]);
    printf("%6u | %2u\n", count, result[i]);
    ck_assert_uint_eq(count, result[i]);
  }
}
END_TEST

START_TEST(test_s21_mantissa_add) {
  printf("test_s21_mantissa_add\n");
  s21_decimal dec_num[] = {{{0, 0, 0xFFFFFFFF, 0}},
                           {{0, 0, 0, 0}},
                           {{1, 0, 0, 0}},
                           {{0, 3, 0, 0}},
                           {{456, 0, 7, 0}},
                           {{0xFFFFFFFF, 0, 0, 0}},
                           {{0, 0xFFFFFFFF, 0, 0}},
                           {{0xFDE648AF, 0, 0, 0}},
                           {{0xFADE74ED, 0x3958, 0, 0}}};
  char *dec_str_ans[] = {
      "000000000000000000000000000000001111111111111111111111111111111000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000010",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000011000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000111000000000"
      "00000000000000000000000000000000000000000000001110010000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000111111111111111111111111111111110",
      "000000000000000000000000000000000000000000000000000000000000000111111111"
      "11111111111111111111111000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000111111011110011001001000101011110",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000011100101011000111110101101111001110100111011010"};
  s21_decimal dec_num_ans = {{0, 0, 0, 0}};
  for (size_t i = 0; i < 9; ++i) {
    int result = s21_mantissa_add(dec_num[i], dec_num[i], &dec_num_ans);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_num_ans, dec_str);
    printf("%s | %d\n", dec_str, result);
    ck_assert_str_eq(dec_str, dec_str_ans[i]);
    ck_assert_int_eq(result, i > 0 ? 0 : 1);
  }
  ck_assert_int_eq(s21_mantissa_add(dec_num[1], dec_num[2], NULL), 1);
}
END_TEST

START_TEST(test_s21_mantissa_left_shift) {
  printf("test_s21_mantissa_left_shift\n");
  const s21_decimal dec_num[] = {{{5, 0, 0, 0}}, {{0xffffffff, 0, 0, 0}}};
  size_t shift[] = {0, 3, 30, 61, 94, 93};
  char *dec_str_ans[] = {
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000101",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000101000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000101000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000010100000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000101",
      "000000000000000000000000000000001010000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",

      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000011111111111111111111111111111111",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000011111111111111111111111111111111000",
      "000000000000000000000000000000000000000000000000000000000000000000111111"
      "11111111111111111111111111000000000000000000000000000000",
      "000000000000000000000000000000000001111111111111111111111111111111100000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000"};
  for (size_t j = 0; j < 2; ++j) {
    for (size_t i = 0; i < 6; ++i) {
      s21_decimal dec_num_ = dec_num[j];
      int result = s21_mantissa_left_shift(&dec_num_, shift[i]);
      char dec_str[129] = {'\0'};
      s21_decimal_to_str(&dec_num_, dec_str);
      printf("%s | %d\n", dec_str, result);
      if (!result) ck_assert_str_eq(dec_str, dec_str_ans[j * 6 + i]);
      ck_assert_int_eq(
          result, (j == 0 && i == 4) || (j == 1 && (i == 4 || i == 5)) ? 1 : 0);
    }
  }
  ck_assert_int_eq(s21_mantissa_left_shift(NULL, shift[1]), 1);
}
END_TEST

START_TEST(test_s21_mantissa_right_shift) {
  printf("test_s21_mantissa_right_shift\n");
  const s21_decimal dec_num[] = {{{0, 0, 40, 0}}, {{0, 0xffffffff, 0, 0}}};
  size_t shift[] = {0, 3, 30, 61, 94, 93};
  char *dec_str_ans[] = {
      "000000000000000000000000000000000000000000000000000000000010100000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000010100000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000001010000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000101000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",

      "000000000000000000000000000000000000000000000000000000000000000011111111"
      "11111111111111111111111100000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000011111"
      "11111111111111111111111111100000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000001111111111111111111111111111111100",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000111",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000"};
  for (size_t j = 0; j < 2; ++j) {
    for (size_t i = 0; i < 6; ++i) {
      s21_decimal dec_num_ = dec_num[j];
      int result = s21_mantissa_right_shift(&dec_num_, shift[i]);
      char dec_str[129] = {'\0'};
      s21_decimal_to_str(&dec_num_, dec_str);
      printf("%s | %d\n", dec_str, result);
      ck_assert_str_eq(dec_str, dec_str_ans[j * 6 + i]);
    }
  }
  ck_assert_int_eq(s21_mantissa_right_shift(NULL, shift[1]), 1);
}
END_TEST

START_TEST(test_s21_mantissa_mul) {
  printf("test_s21_mantissa_mul\n");
  s21_decimal dec_num_1[] = {{{2, 0, 0, 0}},
                             {{0xffffffff, 0x1ffff, 0, 0}},
                             {{0, 0, 0xffffffff, 0}},
                             {{0, 0, 0, 0}},
                             {{0, 0, 0, 0}},
                             {{1, 0, 0, 0}},
                             {{1, 0, 0, 0}},
                             {{5, 0, 0, 0}},
                             {{0xF35CAEE5, 0, 0, 0}},
                             {{0xF5C40000, 0x5AED, 0, 0}},
                             {{0xffffffff, 0, 0, 0}},
                             {{0xffffffff, 0, 0xffffffff, 0}},
                             {{0xffffffff, 0xffffffff, 0x1fffffff, 0}},
                             {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
                             {{1, 0, 0, 0}}};

  s21_decimal dec_num_2[] = {{{0xffffffff, 0xffffffff, 0xffffffff, 0}},
                             {{0xffffffff, 0xffff, 0, 0}},
                             {{2, 0, 0, 0}},
                             {{0, 0, 0, 0}},
                             {{1, 0, 0, 0}},
                             {{0, 0, 0, 0}},
                             {{1, 0, 0, 0}},
                             {{5, 0, 0, 0}},
                             {{0xDAEFD356, 0, 0, 0}},
                             {{0xCDA30000, 0xF643, 0, 0}},
                             {{5, 0, 0, 0}},
                             {{0, 0, 0, 0}},
                             {{3, 0, 0, 0}},
                             {{1, 0, 0, 0}},
                             {{0xffffffff, 0xffffffff, 0xffffffff, 0}}};

  s21_decimal dec_num_res = {{0, 0, 0, 0}};
  char *dec_str_ans[] = {
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000001",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000011001",
      "000000000000000000000000000000000000000000000000000000000000000011010000"
      "00100000111010010101110101101111000101000111111111101110",
      "000000000000000000000000000000000101011101111000101111110111110000011101"
      "10011101011011111100110000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000010011111111111111111111111111111011",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000101111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111101",
      "000000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111111",
      "000000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111111"};
  for (size_t i = 0; i < 15; ++i) {
    int result = s21_mantissa_mul(dec_num_1[i], dec_num_2[i], &dec_num_res);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_num_res, dec_str);
    printf("%s | %d\n", dec_str, result);
    if (i < 3) {
      ck_assert_int_eq(result, 1);
    } else {
      ck_assert_str_eq(dec_str, dec_str_ans[i]);
      ck_assert_int_eq(result, 0);
    }
  }
  ck_assert_int_eq(s21_mantissa_mul(dec_num_1[8], dec_num_2[8], NULL), 1);
}
END_TEST

START_TEST(test_s21_mantissa_sub) {
  printf("test_s21_mantissa_sub\n");
  s21_decimal dec_num_1[] = {
      {{12, 0, 0, 0}},
      {{4, 0, 0, 0}},
      {{6, 0, 0, 0}},
      {{12, 0, 0, 0}},
      {{11, 0, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{5, 0, 0, 0}},
      {{5, 0, 0, 0}},
      {{0, 0xACFE0000, 0xFE56, 0}},
      {{0xCCAE0000, 0x8DFAD46D, 0xE437, 0}},
  };

  s21_decimal dec_num_2[] = {
      {{320, 0, 0, 0}},
      {{5, 0, 0, 0}},
      {{4, 0, 0, 0}},
      {{3, 0, 0, 0}},
      {{5, 0, 0, 0}},
      {{0xffffffff, 1, 0, 0}},
      {{0, 0, 0, 0}},
      {{1, 0, 0, 0}},
      {{0, 0xA8360000, 0xCE48, 0}},
      {{0x65530000, 0xAD42DCE2, 0xCF6E, 0}},
  };

  s21_decimal dec_num_res = {{0, 0, 0, 0}};
  char *dec_str_ans[] = {
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000010",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000001001",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000110",
      "000000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000101",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000100",
      "000000000000000000000000000000000000000000000000001100000000111000000100"
      "11001000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000101001100100011100000"
      "10110111111101111000101101100111010110110000000000000000",
  };
  for (size_t i = 0; i < 10; ++i) {
    int result = s21_mantissa_sub(dec_num_1[i], dec_num_2[i], &dec_num_res);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_num_res, dec_str);
    printf("%s | %d\n", dec_str, result);
    if (i < 2) {
      ck_assert_int_eq(result, 1);
    } else {
      ck_assert_str_eq(dec_str, dec_str_ans[i]);
      ck_assert_int_eq(result, 0);
    }
  }
  ck_assert_int_eq(s21_mantissa_sub(dec_num_1[3], dec_num_2[3], NULL), 1);
}
END_TEST

START_TEST(test_s21_mantissa_div) {
  printf("test_s21_mantissa_div\n");
  s21_decimal dec_num_1[] = {
      {{12, 0, 0, 0}},
      {{18, 0, 0, 0}},
      {{4, 0, 0, 0}},
      {{4, 0, 0, 0}},
      {{4, 0, 0, 0}},
      {{0, 0, 0, 0}},
      {{0x7FAD73FD, 0xFE52, 0, 0}},
      {{0xDE6EE666, 0x76EDFD6E, 0, 0}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0}},
      {{17, 0, 0, 0}},
  };

  s21_decimal dec_num_2[] = {
      {{2, 0, 0, 0}},
      {{6, 0, 0, 0}},
      {{1, 0, 0, 0}},
      {{6, 0, 0, 0}},
      {{8, 0, 0, 0}},
      {{8, 0, 0, 0}},
      {{0x6ED3, 0, 0, 0}},
      {{0xD7EC6456, 0xEF, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{3, 0, 0, 0}},
  };

  s21_decimal dec_num_res = {{0, 0, 0, 0}};
  s21_decimal dec_num_rem = {{0, 0, 0, 0}};
  char *dec_str_ans[] = {
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000110",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000011",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000100",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000001001001011011110011011000110111110",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000011111101111000011101011",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000101",
  };
  for (size_t i = 0; i < 10; ++i) {
    int result = s21_mantissa_div(dec_num_1[i], dec_num_2[i], &dec_num_res,
                                  &dec_num_rem);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_num_res, dec_str);
    printf("%s | %d\n", dec_str, result);
    if (i == 9) {
      ck_assert_int_eq(dec_num_rem.bits[0], 2);
    } else {
      ck_assert_str_eq(dec_str, dec_str_ans[i]);
      ck_assert_int_eq(result, 0);
    }
  }
  ck_assert_int_eq(s21_mantissa_div(dec_num_1[1], dec_num_2[1], NULL, NULL), 1);
  ck_assert_int_eq(
      s21_mantissa_div(dec_num_1[1], dec_num_2[1], &dec_num_res, NULL), 0);
  s21_set_decimal_to_zero(&dec_num_res);
  ck_assert_int_eq(
      s21_mantissa_div(dec_num_1[1], dec_num_res, &dec_num_res, NULL), 1);
}
END_TEST

START_TEST(test_s21_set_mantissa) {
  printf("test_s21_set_mantissa\n");
  ck_assert_int_eq(s21_set_mantissa(NULL, 456), 1);
}
END_TEST

START_TEST(test_s21_div) {
  printf("test_s21_div\n");
  printf("Должно быть | Мой вывод\n");
  s21_decimal dec_num_1[] = {
      {{10, 0, 0, 0}},
      {{0, 0, 0, 0}},
      {{35, 0, 0, 0}},
      {{1, 0, 0, 0x801b0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{66, 0, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{10, 0, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{1, 1, 1, 0xa0000}},
      {{10, 0, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x30000}},
      {{10, 0, 0, 0}},
      {{1, 0, 0, 0x1c0000}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{15, 0, 0, 0}},
      {{10, 0, 0, 0}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 0, 0, 0x10000}},     {{10, 0, 0, 0x10000}},
      {{8, 0, 0, 0}},           {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{1, 0, 0, 0x801b0000}},  {{33, 0, 0, 0x80030000}},
      {{3, 0, 0, 0x1b0000}},    {{3, 0, 0, 0}},
      {{1, 0, 0, 0x10000}},     {{2, 0, 0, 0x801c0000}},
      {{1, 10, 1, 0x800f0000}}, {{22, 0, 0, 0x10000}},
      {{1, 0, 0, 0x10000}},     {{0x70000000, -1291644761, -500259693, 0}},
      {{4, 0, 0, 0x80000000}},  {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{1, 0, 0, 0}},           {{2, 0, 0, 0}},
      {{3, 0, 0, 0}},           {{2, 0, 0, 0x40000}},
      {{6, 0, 0, 0x80000000}},  {{6, 0, 0, 0}},
      {{4, 0, 0, 0}},           {{6, 0, 0, 0}},
      {{11, 0, 0, 0}},
  };

  s21_decimal dec_res = {{0, 0, 0, 0}};

  char *dec_str_ans[] = {
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000001100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000001000100010111",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "100000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000011111010000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000001110000000000000000000110101110110100101011111110010011001111"
      "00100110000001111110111000110101010101010101010101010101",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "100000000001011100000000000000000010000001001111110011100101110100011011"
      "01010110110000010001110000111100110000010111011101001000",
      "000000000001110000000000000000001001001011011111000111100110011010001110"
      "11010110110001001111111100000010111010001011101000101111",
      "000000000000001000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111111",
      "000000000001110000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000001",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000001110000000000000000000010000001001111110011100101111000111110"
      "00100101000000100110000100010000000000000000000000000000",
      "000000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111111",
      "000000000000000000000000000000001000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000101010101010101010101010101010101010101"
      "01010101010101010101010101010101010101010101010101010101",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "100000000000000100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000011001",
      "000000000001110000000000000000000011010111011010010101111111001001100111"
      "10010011000000111111011100011010101010101010101010101011",
      "000000000000000000000000000000000100000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000010101010101010101010101010101010101010"
      "10101010101010101010101010101010101010101010101010101010",
      "000000000000000100000000000000001110100010111010001011101000101110100010"
      "11101000101110100010111010001011101000101110100010111001",
  };

  int results[] = {3, 0, 0, 0, 2, 0, 1, 0, 1, 2, 0, 0, 0,
                   0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0};
  for (size_t i = 0; i < 25; ++i) {
    int result = s21_div(dec_num_1[i], dec_num_2[i], &dec_res);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_res, dec_str);
    printf("%11d | %d\n", results[i], result);
    ck_assert_str_eq(dec_str, dec_str_ans[i]);
    ck_assert_int_eq(result, results[i]);
  }
  ck_assert_int_eq(s21_div(dec_num_1[0], dec_num_2[0], NULL), 4);
}
END_TEST

START_TEST(test_s21_floor) {
  printf("test_s21_floor\n");
  s21_decimal dec_num_1[] = {
      {{1501, 0, 0, 0x30000}},
      {{1501, 0, 0, 0x80030000}},
      {{1, 0, 0, 0x1c0000}},
      {{1, 0, 0, 0x801c0000}},
      {{1499911188, 0, 0, 0xa0000}},
      {{1499911188, 0, 0, 0x800a0000}},
      {{1499911188, 0, 0, 0x90000}},
      {{1499911188, 0, 0, 0x80090000}},
      {{1499911188, 0, 0, 0x80000}},
      {{1499911188, 0, 0, 0x80080000}},
      {{1499911188, 0, 0, 0x70000}},
      {{1499911188, 0, 0, 0x80070000}},
      {{1499911188, 0, 0, 0x60000}},
      {{1499911188, 0, 0, 0x80060000}},
      {{1499911188, 0, 0, 0x50000}},
      {{1499911188, 0, 0, 0x80050000}},
      {{1499911188, 0, 0, 0x40000}},
      {{1499911188, 0, 0, 0x80040000}},
      {{1499911188, 0, 0, 0x30000}},
      {{1499911188, 0, 0, 0x80030000}},
      {{1499911188, 0, 0, 0x20000}},
      {{1499911188, 0, 0, 0x80020000}},
      {{1499911188, 0, 0, 0x10000}},
      {{1499911188, 0, 0, 0x80010000}},
      {{1499911188, 0, 0, 0}},
      {{1499911188, 0, 0, 0x80000000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x1c0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801c0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x1b0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801b0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x190000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x80190000}},
  };

  s21_decimal dec_res = {{0, 0, 0, 0}};

  int results[] = {
      1,        2,         0,         1,          0,          1,       1,
      2,        14,        15,        149,        150,        1499,    1500,
      14999,    15000,     149991,    149992,     1499911,    1499912, 14999111,
      14999112, 149991118, 149991119, 1499911188, 1499911188, 7,       8,
      79,       80,        7922,      7923};
  for (size_t i = 0; i < 32; ++i) {
    int result = s21_floor(dec_num_1[i], &dec_res);
    printf("%10d | %10u | %d\n", results[i], dec_res.bits[0], result);
    ck_assert_int_eq(results[i], dec_res.bits[0]);
    ck_assert_int_eq(result, 0);
  }
  ck_assert_int_eq(s21_floor(dec_res, NULL), 1);
}
END_TEST

START_TEST(test_s21_from_decimal_to_float) {
  printf("test_s21_from_decimal_to_float\n");

  static s21_decimal src[] = {
      {{0x000026B9, 0x00000000, 0x00000000, 0x00030000}},
      {{0x00000000, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x80000000}},
      {{0x00000002, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00000002, 0x00000000, 0x00000000, 0x80000000}},
      {{0x0000000F, 0x00000000, 0x00000000, 0x00010000}},
      {{0x0000000F, 0x00000000, 0x00000000, 0x80010000}},
      {{0x00000009, 0x00000000, 0x00000000, 0x00010000}},
      {{0x00000009, 0x00000000, 0x00000000, 0x80010000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x80010000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x00010000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x80010000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00010000}},
      {{0x000031DD, 0x00000000, 0x00000000, 0x00030000}},
      {{0x00002F0D, 0x00000000, 0x00000000, 0x80030000}},
      {{0x0001869F, 0x00000000, 0x00000000, 0x00040000}},
      {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x00000000}},
      {{0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0x80000000}},
      {{0x000000D3, 0x00007C45, 0x00007C57, 0x80080000}},
      {{0x003A6E50, 0x007F1483, 0x003215CF, 0x00020000}},
      {{0x00000000, 0x00000000, 0x00000000, 0x800A0000}},
      {{0xF533512E, 0x0000004B, 0x00000000, 0x00060000}},
      {{0x51A337CD, 0x00000002, 0x00000000, 0x80040000}},
      {{0xDC425734, 0x01C068FA, 0x00000000, 0x00070000}},
      {{0xCC133B70, 0x004D86D4, 0x00000000, 0x000B0000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x00140000}},
  };

  static float dst[] = {
      9.91300011f,
      0.f,
      1.f,
      -1.f,
      2.f,
      -2.f,
      1.5f,
      -1.5f,
      0.899999976f,
      -0.899999976f,
      -0.100000001f,
      0.100000001f,
      -1.10000002f,
      1.10000002f,
      12.7650003f,
      -12.0450001f,
      9.99989986f,
      79228162500000000000000000000.f,
      -79228162500000000000000000000.f,
      -5871782930000000.f,
      605492757000000000000000.f,
      0.f,
      326236.344f,
      -995958.563f,
      12621621200.f,
      218218.219f,
      9.99999968E-21f,
  };

  for (size_t i = 0; i < sizeof(src) / sizeof(s21_decimal); ++i) {
    float tmp;
    int ret = s21_from_decimal_to_float(src[i], &tmp);
    if (tmp != dst[i]) {
      char buf1[512];
      char buf2[512];
      sprintf(buf1, "%.6E", tmp);
      sprintf(buf2, "%.6E", dst[i]);
      ck_assert(strcmp(buf1, buf2) == 0);
    } else {
      ck_assert_float_eq(tmp, dst[i]);
      ck_assert_int_eq(ret, 0);
    }
  }
}
END_TEST

START_TEST(test_s21_from_decimal_to_int) {
  printf("test_s21_from_decimal_to_int\n");
  s21_decimal dec_num_1[] = {
      {{0, 0, 0x19999999, 0x50000}},
      {{0, 12, 0, 0x80050000}},
      {{0, 12, 0, 0x800b0000}},
      {{0x6635E3DD, 0x7B25226E, 0, 0xb0000}},
      {{0, 0, 0, 0}},
      {{0xEA2E6C54, 0x271BEAF9, 0x19BC1D69, 0x140000}},
      {{9, 0, 0, 0x30000}},
  };
  int int_num[] = {0, -515396, 0, 88735364, 0, 79645421, 0};
  for (size_t i = 0; i < 7; ++i) {
    int dst;
    int result = s21_from_decimal_to_int(dec_num_1[i], &dst);
    printf("%10d | %10d | %d\n", int_num[i], dst, result);
    ck_assert_int_eq(int_num[i], dst);
    ck_assert_int_eq(result, i < 1 ? 1 : 0);
  }
  ck_assert_int_eq(s21_from_decimal_to_int(dec_num_1[1], NULL), 1);
}
END_TEST

START_TEST(test_s21_from_float_to_decimal) {
  printf("test_s21_from_float_to_decimal\n");
  printf("working cases\n");
  static float src[] = {
      1e-28f,
      1.00000003e-27f,
      1.19999996e-27f,
      1.50000004e-27f,
      1.89999999e-27f,
      9.99999989e-27f,
      1.23000001e-26f,
      1.50999995e-26f,
      1.89999999e-26f,

      1.00000002e-25f,
      1.23699997e-25f,
      1.51899999e-25f,
      1.90599999e-25f,
      1.00000002E-24f,
      2.21370009E-24f,
      7.51489961E-24f,
      4.91059997E-24f,
      1E-23f,
      2.21370005E-23f,

      7.51148999E-23f,
      4.94105994E-23f,
      1.10000002E-22f,
      2.21327006E-22f,
      7.51419017E-22f,
      4.91095979E-22f,
      1.09999997E-21f,
      2.21369991E-21f,
      7.51490032E-21f,
      4.91060012E-21f,

      1.09999997E-20f,
      2.21369995E-20f,
      7.51490032E-20f,
      4.91060003E-20f,
      1.10000003E-19f,
      2.21369998E-19f,
      7.51490019E-19f,
      4.9106001E-19f,
      1.09999998E-18f,
      2.21369993E-18f,

      7.5149003E-18f,
      4.91059989E-18f,
      1.1E-17f,
      2.21369993E-17f,
      7.51490013E-17f,
      4.91060006E-17f,
      1.1E-16f,
      2.21369996E-16f,
      7.51490013E-16f,
      4.91059993E-16f,

      1.09999997E-15f,
      2.21370007E-15f,
      7.51490002E-15f,
      4.91059982E-15f,
      1.10000001E-14f,
      2.21369994E-14f,
      7.51490002E-14f,
      4.91059999E-14f,
      1.10000001E-13f,
      2.21370001E-13f,

      7.51490016E-13f,
      4.91059992E-13f,
      1.09999997E-12f,
      2.21369993E-12f,
      7.51490016E-12f,
      4.91060014E-12f,
      1.10000004E-11f,
      2.21370006E-11f,
      7.51489981E-11f,
      4.91060005E-11f,

      1.10000002E-10f,
      2.21370006E-10f,
      7.51489981E-10f,
      4.91060026E-10f,
      1.09999998E-09f,
      2.21369989E-09f,
      7.51489981E-09f,
      4.91059993E-09f,
      1.1E-08f,
      2.21369998E-08f,

      7.51490035E-08f,
      4.91059993E-08f,
      1.10000002E-07f,
      2.21370001E-07f,
      7.51490006E-07f,
      4.91060007E-07f,
      1.09999996E-06f,
      2.2137001E-06f,
      7.51490006E-06f,
      4.91060018E-06f,

      1.10000001E-05f,
      2.21369992E-05f,
      7.51490006E-05f,
      4.91059982E-05f,
      0.000110000001f,
      0.000221370006f,
      0.000751490006f,
      0.000491060026f,
      0.00109999999f,
      0.00221369998f,

      0.00751490006f,
      0.00491059991f,
      0.0109999999f,
      0.0221369993f,
      0.0751489997f,
      0.0491060019f,
      0.109999999f,
      0.221369997f,
      0.751489997f,
      0.491059989f,

      1.00999999f,
      1.00730002f,
      1.100281f,
      1.83182812f,
      2.38182998f,
      -1.f,
      1.f,
      -2.f,
      2.f,

      -3.f,
      3.f,
      -10.f,
      10.f,
      -128.f,
      127.f,
      255.f,
      -32768.f,
      32767.f,
      -32767.f,

      137.f,
      342.f,
      -32860.f,
      33223.f,
      56210.f,
      -65535.f,
      65535.f,
      212818288.f,
      -2818281.f,
      -2147483650.f,

      100.f,
      1782.f,
      -821821.f,
      218128.f,
      9999.f,
      -9999999.f,
      2147483650.f,
      -2147483650.f,
      0.120010003f,
      0.465000004f,

      0.0465000011f,
      4.65000012E-05f,
      0.999999881f,
      16253.0186f,
      1E-28f,
      -9999999440000000000000000000.f,
      12345678.f,
      1234567.5f,
      1234567.88f,
      -0.00167000003f,

      19.9999981f,
      -0.923458755f,
      70172132300000000000000000000.f,
      7211721240000000000000000000.f,
      734172150000000000000000000.f,
      74172130500000000000000000.f,
      7517213080000000000000000.f,
      761721331000000000000000.f,
      72172129600000000000000.f,
      7312172140000000000000.f,

      774721734000000000000.f,
      74231170200000000000.f,
      7858172220000000000.f,
      718667188000000000.f,
      71729664700000000.f,
      7172868650000000.f,
      717212092000000.f,
      0.00000000000000000000000000016929383838292f,
      0.00000000000000000000000858598287381972f,
  };

  static s21_decimal dst[] = {
      {{0x00000001, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x001B0000}},
      {{0x0000000C, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x0000000F, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000013, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x001A0000}},
      {{0x0000007B, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000097, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000013, 0x00000000, 0x00000000, 0x001B0000}},

      {{0x00000001, 0x00000000, 0x00000000, 0x00190000}},
      {{0x000004D5, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x000005EF, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000772, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x00180000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x00170000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x001B0000}},

      {{0x000B762D, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x00078A1A, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00170000}},
      {{0x0003608F, 0x00000000, 0x00000000, 0x001B0000}},
      {{0x000B773B, 0x00000000, 0x00000000, 0x001B0000}},
      {{0x00077E58, 0x00000000, 0x00000000, 0x001B0000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00160000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00190000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00190000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00190000}},

      {{0x0000000B, 0x00000000, 0x00000000, 0x00150000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00180000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00180000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00180000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00140000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00170000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00170000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00170000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00130000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00160000}},

      {{0x0001258D, 0x00000000, 0x00000000, 0x00160000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00160000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00120000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00150000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00150000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00150000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00110000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00140000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00140000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00140000}},

      {{0x0000000B, 0x00000000, 0x00000000, 0x00100000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00130000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00130000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00130000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x000F0000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00120000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00120000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00120000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x000E0000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00110000}},

      {{0x0001258D, 0x00000000, 0x00000000, 0x00110000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00110000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x000D0000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00100000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00100000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00100000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x000C0000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x000F0000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x000F0000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x000F0000}},

      {{0x0000000B, 0x00000000, 0x00000000, 0x000B0000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x000E0000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x000E0000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x000E0000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x000A0000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x000D0000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x000D0000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x000D0000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00090000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x000C0000}},

      {{0x0001258D, 0x00000000, 0x00000000, 0x000C0000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x000C0000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00080000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x000B0000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x000B0000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x000B0000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00070000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x000A0000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x000A0000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x000A0000}},

      {{0x0000000B, 0x00000000, 0x00000000, 0x00060000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00090000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00090000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00090000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00050000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00080000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00080000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00080000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00040000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00070000}},

      {{0x0001258D, 0x00000000, 0x00000000, 0x00070000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00070000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00030000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00060000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00060000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00060000}},
      {{0x0000000B, 0x00000000, 0x00000000, 0x00020000}},
      {{0x00005679, 0x00000000, 0x00000000, 0x00050000}},
      {{0x0001258D, 0x00000000, 0x00000000, 0x00050000}},
      {{0x0000BFD2, 0x00000000, 0x00000000, 0x00050000}},

      {{0x00000065, 0x00000000, 0x00000000, 0x00020000}},
      {{0x00002759, 0x00000000, 0x00000000, 0x00040000}},
      {{0x0010C9F9, 0x00000000, 0x00000000, 0x00060000}},
      {{0x001BF394, 0x00000000, 0x00000000, 0x00060000}},
      {{0x0003A267, 0x00000000, 0x00000000, 0x00050000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x80000000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00000002, 0x00000000, 0x00000000, 0x80000000}},
      {{0x00000002, 0x00000000, 0x00000000, 0x00000000}},

      {{0x00000003, 0x00000000, 0x00000000, 0x80000000}},
      {{0x00000003, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0000000A, 0x00000000, 0x00000000, 0x80000000}},
      {{0x0000000A, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00000080, 0x00000000, 0x00000000, 0x80000000}},
      {{0x0000007F, 0x00000000, 0x00000000, 0x00000000}},
      {{0x000000FF, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00008000, 0x00000000, 0x00000000, 0x80000000}},
      {{0x00007FFF, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00007FFF, 0x00000000, 0x00000000, 0x80000000}},

      {{0x00000089, 0x00000000, 0x00000000, 0x00000000}},
      {{0x00000156, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0000805C, 0x00000000, 0x00000000, 0x80000000}},
      {{0x000081C7, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0000DB92, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0000FFFF, 0x00000000, 0x00000000, 0x80000000}},
      {{0x0000FFFF, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0CAF597C, 0x00000000, 0x00000000, 0}},
      {{0x002B00E9, 0x00000000, 0x00000000, 0x80000000}},
      {{0x80000160, 0x00000000, 0x00000000, 0x80000000}},

      {{0x00000064, 0x00000000, 0x00000000, 0x00000000}},
      {{0x000006F6, 0x00000000, 0x00000000, 0x00000000}},
      {{0x000C8A3D, 0x00000000, 0x00000000, 0x80000000}},
      {{0x00035410, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0000270F, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0098967F, 0x00000000, 0x00000000, 0x80000000}},
      {{0x80000160, 0x00000000, 0x00000000, 0x00000000}},
      {{0x80000160, 0x00000000, 0x00000000, 0x80000000}},
      {{0x00002EE1, 0x00000000, 0x00000000, 0x00050000}},
      {{0x000001D1, 0x00000000, 0x00000000, 0x00030000}},

      {{0x000001D1, 0x00000000, 0x00000000, 0x00040000}},
      {{0x000001D1, 0x00000000, 0x00000000, 0x00070000}},
      {{0x0098967F, 0x00000000, 0x00000000, 0x00070000}},
      {{0x0018CCD6, 0x00000000, 0x00000000, 0x00020000}},
      {{0x00000001, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x31600000, 0x085B549B, 0x204FCE28, 0x80000000}},
      {{0x00BC6150, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0012D688, 0x00000000, 0x00000000, 0x00000000}},
      {{0x0012D688, 0x00000000, 0x00000000, 0x00000000}},
      {{0x000000A7, 0x00000000, 0x00000000, 0x80050000}},

      {{0x00000014, 0x00000000, 0x00000000, 0x00000000}},
      {{0x008CE89C, 0x00000000, 0x00000000, 0x80070000}},
      {{0xA9400000, 0xB25EFECA, 0xE2BD0685, 0x00000000}},
      {{0x0BA00000, 0xC728D3CE, 0x174D6552, 0x00000000}},
      {{0x94900000, 0x4A37B072, 0x025F4AFD, 0x00000000}},
      {{0x1E480000, 0x3964C4DD, 0x003D5A8F, 0x00000000}},
      {{0x46540000, 0xEEEB8E94, 0x000637D4, 0x00000000}},
      {{0x52E20000, 0xFE91F196, 0x0000A14C, 0x00000000}},
      {{0xC0FD0000, 0x75817AAA, 0x00000F48, 0x00000000}},
      {{0xCD9E0000, 0x64C57C73, 0x0000018C, 0x00000000}},

      {{0x9EBE4000, 0xFF6C617F, 0x00000029, 0x00000000}},
      {{0x47A22000, 0x062A17D2, 0x00000004, 0x00000000}},
      {{0xB3EBC000, 0x6D0DD5CC, 0x00000000, 0x00000000}},
      {{0xBFB98000, 0x09F93802, 0x00000000, 0x00000000}},
      {{0xE828D800, 0x00FED5BE, 0x00000000, 0x00000000}},
      {{0xB4C3F200, 0x00197BAF, 0x00000000, 0x00000000}},
      {{0xF472F900, 0x00028C4C, 0x00000000, 0x00000000}},
      {{0x00000002, 0x00000000, 0x00000000, 0x001C0000}},
      {{0x0000218A, 0x00000000, 0x00000000, 0x001B0000}},

  };

  unsigned iter = 1;
  for (size_t i = 0; i < sizeof(src) / sizeof(float); ++i) {
    s21_decimal tmp = {{0, 0, 0, 0}};
    int ret = s21_from_float_to_decimal(src[i], &tmp);
    printf("%u.\n", iter);
    printf("s21:    ");
    print_decimal(&tmp);
    printf("Sample: ");
    print_decimal(&dst[i]);

    ck_assert_int_eq(tmp.bits[0], dst[i].bits[0]);
    ck_assert_int_eq(tmp.bits[1], dst[i].bits[1]);
    ck_assert_int_eq(tmp.bits[2], dst[i].bits[2]);
    ck_assert_int_eq(tmp.bits[3], dst[i].bits[3]);
    ck_assert_int_eq(ret, 0);
    iter++;
  }
  s21_decimal tmp_err = {{0, 0, 0, 0}};
  int ret_err = s21_from_float_to_decimal(INFINITY, &tmp_err);
  ck_assert_int_eq(ret_err, 1);
  ret_err = s21_from_float_to_decimal(-INFINITY, &tmp_err);
  ck_assert_int_eq(ret_err, 1);
  ret_err = s21_from_float_to_decimal(0, &tmp_err);
  ck_assert_int_eq(ret_err, 1);
}
END_TEST

START_TEST(test_s21_from_int_to_decimal) {
  printf("test_s21_from_int_to_decimal\n");
  int int_num[] = {-222, 0, -0, 333, INT_MAX, INT_MIN};
  for (size_t i = 0; i < 6; ++i) {
    s21_decimal dec_num;
    unsigned sign = int_num[i] < 0;
    int result = s21_from_int_to_decimal(int_num[i], &dec_num);
    printf("%12u | %12u | %u | %u | %d\n", dec_num.bits[0],
           (unsigned)abs(int_num[i]), s21_checkbit(dec_num.bits[3], 31), sign,
           result);
    ck_assert_uint_eq(dec_num.bits[0], (unsigned)abs(int_num[i]));
    ck_assert_uint_eq(s21_checkbit(dec_num.bits[3], 31), sign);
    ck_assert_int_eq(result, 0);
  }
  ck_assert_int_eq(s21_from_int_to_decimal(100, NULL), 1);
}
END_TEST

START_TEST(test_s21_is_equal) {
  printf("test_s21_is_equal\n");
  s21_decimal dec_num_1[] = {
      {{0, 0, 0, 0x80090000}}, {{0, 0, 0, 0x90000}},    {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},

      {{0, 0, 0, 0x80090000}}, {{0, 0, 0, 0x90000}},    {{0, 5, 0, 0x80090000}},
      {{0, 5, 0, 0x90000}},

      {{5, 0, 0, 0x10000}},    {{5, 0, 0, 0x80010000}}, {{5, 0, 0, 0x10000}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 0, 0, 0xa0000}},     {{0, 0, 0, 0x800a0000}},
      {{0, 0, 0, 0x80040000}},  {{0, 0, 0, 0x1a0000}},

      {{0, 5, 0, 0xa0000}},     {{0, 5, 0, 0x800a0000}},
      {{0, 0, 0, 0xa0000}},     {{0, 0, 0, 0x800a0000}},

      {{50000, 0, 0, 0x50000}}, {{50000, 0, 0, 0x80050000}},
      {{50000, 0, 0, 0x40000}},
  };

  int results[] = {1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0};
  for (size_t i = 0; i < 11; ++i) {
    int result = s21_is_equal(dec_num_1[i], dec_num_2[i]);
    printf("%d | %d\n", results[i], result);
    ck_assert_int_eq(result, results[i]);
  }
}
END_TEST

START_TEST(test_s21_is_greater) {
  printf("test_s21_is_greater\n");
  s21_decimal dec_num_1[] = {
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 5, 0, 0x80090000}},
      {{0, 5, 0, 0x90000}},
      {{2, 0, 0, 0}},
      {{2, 0, 0, 0x80000000}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{2, 0, 0, 0}},
      {{20, 0xfde35554, 0xdef47a58, 0x80040000}},
      {{20, 0xfde35554, 0xdef47a58, 0x40000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0, 0, 0, 0x80040000}},
      {{0, 0, 0, 0x1a0000}},
      {{0, 5, 0, 0xa0000}},
      {{0, 5, 0, 0x800a0000}},
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0, 6, 0, 0}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{7, 0, 0, 0x80000000}},
      {{7, 0, 0, 0}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  int results[] = {0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1,
                   1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0};
  for (size_t i = 0; i < 23; ++i) {
    int result = s21_is_greater(dec_num_1[i], dec_num_2[i]);
    printf("%d | %d\n", results[i], result);
    ck_assert_int_eq(result, results[i]);
  }
}
END_TEST

START_TEST(test_s21_is_greater_or_equal) {
  printf("test_s21_is_greater_or_equal\n");
  s21_decimal dec_num_1[] = {
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 5, 0, 0x80090000}},
      {{0, 5, 0, 0x90000}},
      {{2, 0, 0, 0}},
      {{2, 0, 0, 0x80000000}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{2, 0, 0, 0}},
      {{20, 0xfde35554, 0xdef47a58, 0x80040000}},
      {{20, 0xfde35554, 0xdef47a58, 0x40000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0, 0, 0, 0x80040000}},
      {{0, 0, 0, 0x1a0000}},
      {{0, 5, 0, 0xa0000}},
      {{0, 5, 0, 0x800a0000}},
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0, 6, 0, 0}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{7, 0, 0, 0x80000000}},
      {{7, 0, 0, 0}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  int results[] = {1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1,
                   1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1};
  for (size_t i = 0; i < 23; ++i) {
    int result = s21_is_greater_or_equal(dec_num_1[i], dec_num_2[i]);
    printf("%d | %d\n", results[i], result);
    ck_assert_int_eq(result, results[i]);
  }
}
END_TEST

START_TEST(test_s21_is_less) {
  printf("test_s21_is_less\n");
  s21_decimal dec_num_1[] = {
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 5, 0, 0x80090000}},
      {{0, 5, 0, 0x90000}},
      {{2, 0, 0, 0}},
      {{2, 0, 0, 0x80000000}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{2, 0, 0, 0}},
      {{20, 0xfde35554, 0xdef47a58, 0x80040000}},
      {{20, 0xfde35554, 0xdef47a58, 0x40000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0, 0, 0, 0x80040000}},
      {{0, 0, 0, 0x1a0000}},
      {{0, 5, 0, 0xa0000}},
      {{0, 5, 0, 0x800a0000}},
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0, 6, 0, 0}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{7, 0, 0, 0x80000000}},
      {{7, 0, 0, 0}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  int results[] = {0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0,
                   0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0};
  for (size_t i = 0; i < 23; ++i) {
    int result = s21_is_less(dec_num_1[i], dec_num_2[i]);
    printf("%d | %d\n", results[i], result);
    ck_assert_int_eq(result, results[i]);
  }
}
END_TEST

START_TEST(test_s21_is_less_or_equal) {
  printf("test_s21_is_less_or_equal\n");
  s21_decimal dec_num_1[] = {
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},
      {{0, 5, 0, 0x80090000}},
      {{0, 5, 0, 0x90000}},
      {{2, 0, 0, 0}},
      {{2, 0, 0, 0x80000000}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{0, 5, 0, 0x80000000}},
      {{0, 5, 0, 0}},
      {{2, 0, 0, 0}},
      {{20, 0xfde35554, 0xdef47a58, 0x80040000}},
      {{20, 0xfde35554, 0xdef47a58, 0x40000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0, 0, 0, 0x80040000}},
      {{0, 0, 0, 0x1a0000}},
      {{0, 5, 0, 0xa0000}},
      {{0, 5, 0, 0x800a0000}},
      {{0, 0, 0, 0xa0000}},
      {{0, 0, 0, 0x800a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801a0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0, 6, 0, 0}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0x80000000}},
      {{0, 6, 0, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{7, 0, 0, 0x80000000}},
      {{7, 0, 0, 0}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
      {{0, 0, 5, 0}},
      {{0, 0, 5, 0x80000000}},
      {{0, 0, 6, 0}},
      {{0, 0, 6, 0x80000000}},
  };

  int results[] = {1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0,
                   0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1};
  for (size_t i = 0; i < 23; ++i) {
    int result = s21_is_less_or_equal(dec_num_1[i], dec_num_2[i]);
    printf("%d | %d\n", results[i], result);
    ck_assert_int_eq(result, results[i]);
  }
}
END_TEST

START_TEST(test_s21_is_not_equal) {
  printf("test_s21_is_not_equal\n");
  s21_decimal dec_num_1[] = {
      {{0, 0, 0, 0x80090000}}, {{0, 0, 0, 0x90000}},    {{0, 0, 0, 0x80090000}},
      {{0, 0, 0, 0x90000}},

      {{0, 0, 0, 0x80090000}}, {{0, 0, 0, 0x90000}},    {{0, 5, 0, 0x80090000}},
      {{0, 5, 0, 0x90000}},

      {{5, 0, 0, 0x10000}},    {{5, 0, 0, 0x80010000}}, {{5, 0, 0, 0x10000}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 0, 0, 0xa0000}},     {{0, 0, 0, 0x800a0000}},
      {{0, 0, 0, 0x80040000}},  {{0, 0, 0, 0x1a0000}},

      {{0, 5, 0, 0xa0000}},     {{0, 5, 0, 0x800a0000}},
      {{0, 0, 0, 0xa0000}},     {{0, 0, 0, 0x800a0000}},

      {{50000, 0, 0, 0x50000}}, {{50000, 0, 0, 0x80050000}},
      {{50000, 0, 0, 0x40000}},
  };

  int results[] = {0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1};
  for (size_t i = 0; i < 11; ++i) {
    int result = s21_is_not_equal(dec_num_1[i], dec_num_2[i]);
    printf("%d | %d\n", results[i], result);
    ck_assert_int_eq(result, results[i]);
  }
}
END_TEST

START_TEST(test_s21_mul) {
  printf("test_s21_mul\n");
  s21_decimal dec_num_1[] = {
      {{2, 0, 0, 0}},
      {{5346, 0, 0, 0}},
      {{4294879641, 49999, 0, 0xe0000}},
      {{4294879641, 49999, 0, 0x800e0000}},
      {{4294879641, 49999, 0, 0x800e0000}},
      {{1, 1, 1, 0xa0000}},
      {{1, 1, 1, 0x800a0000}},
      {{0, 0, 0, 0x80000000}},
      {{4, 0, 0, 0x801a0000}},
      {{4, 0, 0x80000000, 0x80000000}},
      {{4, 0, 0x80000000, 0x80000000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
  };

  s21_decimal dec_num_2[] = {
      {{3, 0, 0, 0}},
      {{5346, 0, 0, 0}},
      {{4294879641, 49999, 0, 0xe0000}},
      {{4294879641, 49999, 0, 0xe0000}},
      {{4294879641, 49999, 0, 0x800e0000}},
      {{1, 1, 1, 0xa0000}},
      {{0, 0, 0, 0xa0000}},
      {{1, 1, 1, 0}},
      {{5, 0, 0, 0xa0000}},
      {{5, 0, 0xffffffff, 0x20000}},
      {{5, 0, 0xffffffff, 0x80010000}},
      {{1, 0, 0, 0x80000000}},
  };

  s21_decimal dec_num_res = {{0, 0, 0, 0}};
  char *dec_str_ans[] = {
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000110",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000001101101000001011110000100",
      "000000000001110000000000000000001001010100000010111110001111110111110101"
      "10001001000101011010000111001001111101110101110101110001",
      "100000000001110000000000000000001001010100000010111110001111110111110101"
      "10001001000101011010000111001001111101110101110101110001",
      "000000000001110000000000000000001001010100000010111110001111110111110101"
      "10001001000101011010000111001001111101110101110101110001",
      "000000000000101000000000000000000110110111110011011111110110100000111010"
      "11011101111010011010111101100010100000011111010111111101",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "100000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111111",
  };
  int results[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 0};
  for (size_t i = 0; i < 12; ++i) {
    int result = s21_mul(dec_num_1[i], dec_num_2[i], &dec_num_res);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_num_res, dec_str);
    printf("%11d | %d\n", results[i], result);
    ck_assert_str_eq(dec_str, dec_str_ans[i]);
    ck_assert_int_eq(result, results[i]);
  }
  ck_assert_int_eq(s21_mul(dec_num_1[1], dec_num_2[1], NULL), 4);
}
END_TEST

START_TEST(test_s21_array_div) {
  printf("test_s21_array_div\n");
  bool val_1[S21_MANTISSA_SIZE * 2] = {true};
  bool val_2[S21_MANTISSA_SIZE * 2] = {false};
  bool res[S21_MANTISSA_SIZE * 2] = {true};
  bool remainder[S21_MANTISSA_SIZE * 2] = {true};
  ck_assert_int_eq(s21_array_div(val_1, val_2, res, remainder), 1);
}
END_TEST

START_TEST(test_s21_negate) {
  printf("test_s21_negate\n");
  int int_num[] = {-222, 0, -0, 333, INT_MAX, INT_MIN};
  s21_decimal dec_num_res;
  s21_decimal dec_num_val = {{0, 0, 0, 0}};
  for (size_t i = 0; i < 6; ++i) {
    s21_from_int_to_decimal(int_num[i], &dec_num_val);
    int result = s21_negate(dec_num_val, &dec_num_res);
    printf("%12u | %12u | %u | %u | %d\n", dec_num_val.bits[0],
           dec_num_res.bits[0], s21_checkbit(dec_num_val.bits[3], 31),
           s21_checkbit(dec_num_res.bits[3], 31), result);
    ck_assert_uint_eq(dec_num_val.bits[0], dec_num_res.bits[0]);
    ck_assert_uint_ne(s21_checkbit(dec_num_val.bits[3], 31),
                      s21_checkbit(dec_num_res.bits[3], 31));
    ck_assert_int_eq(result, 0);
  }
  ck_assert_int_eq(s21_negate(dec_num_val, NULL), 1);
}
END_TEST

START_TEST(test_s21_normalize) {
  printf("test_s21_normalize\n");
  s21_decimal dec_num_1[] = {
      {{0, 12, 0, 0x80050000}},         {{0, 12, 0, 0xb0000}},
      {{0, 0, 0x19999999, 0x50000}},    {{4, 0, 0, 0x800a0000}},
      {{4, 0, 0xffffffff, 0x80010000}},
  };

  s21_decimal dec_num_2[] = {
      {{0, 12, 0, 0xb0000}}, {{0, 12, 0, 0x80050000}}, {{0, 5, 0, 0x80090000}},
      {{1, 0, 0, 0xa0000}},  {{4, 0, 0, 0x801b0000}},
  };

  char *dec_str_ans[] = {
      "100000000000101100000000000000000000000000000000000000000000000000000000"
      "10110111000110110000000000000000000000000000000000000000",
      "000000000000101100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000110000000000000000000000000000000000",

      "000000000000101100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000110000000000000000000000000000000000",
      "100000000000101100000000000000000000000000000000000000000000000000000000"
      "10110111000110110000000000000000000000000000000000000000",

      "000000000000011000000000000000001111111111111111111111111111101000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "100000000000011000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000001010001111010111000010100",

      "100000000000101000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000100",
      "000000000000101000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000001",

      "100000000000000100000000000000001111111111111111111111111111111100000000"
      "00000000000000000000000000000000000000000000000000000100",
      "100000000000000100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
  };
  for (size_t i = 0; i < 5; ++i) {
    s21_normalize(&dec_num_1[i], &dec_num_2[i]);
    char dec_str_1[129] = {'\0'};
    char dec_str_2[129] = {'\0'};
    s21_decimal_to_str(&dec_num_1[i], dec_str_1);
    s21_decimal_to_str(&dec_num_2[i], dec_str_2);
    printf("%s\n%s\n\n", dec_str_1, dec_str_2);
    ck_assert_str_eq(dec_str_1, dec_str_ans[2 * i]);
    ck_assert_str_eq(dec_str_2, dec_str_ans[2 * i + 1]);
  }
}
END_TEST

START_TEST(test_s21_round) {
  printf("test_s21_round\n");
  s21_decimal dec_num_1[] = {
      {{1501, 0, 0, 0x30000}},
      {{1, 0, 0, 0x1c0000}},
      {{1499911188, 0, 0, 0xa0000}},
      {{1499911188, 0, 0, 0x90000}},
      {{1499911188, 0, 0, 0x80000}},
      {{1499911188, 0, 0, 0x80070000}},
      {{1499911188, 0, 0, 0x80060000}},
      {{1499911188, 0, 0, 0x80050000}},
      {{1499911188, 0, 0, 0x80040000}},
      {{1499911188, 0, 0, 0x80030000}},
      {{1499911188, 0, 0, 0x80020000}},
      {{1499911188, 0, 0, 0x80010000}},
      {{1499911188, 0, 0, 0x80000000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801c0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801b0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x80190000}},
      {{45, 0, 0, 0x80020000}},
      {{10, 100, 3, 0x150000}},
  };

  s21_decimal dec_res = {{0, 0, 0, 0}};

  int results[] = {2,          0,     0,      1,       15,       150,
                   1500,       14999, 149991, 1499911, 14999112, 149991119,
                   1499911188, 8,     79,     7923,    0,        0};
  for (size_t i = 0; i < 18; ++i) {
    int result = s21_round(dec_num_1[i], &dec_res);
    printf("%10d | %10u | %d\n", results[i], dec_res.bits[0], result);
    ck_assert_int_eq(results[i], dec_res.bits[0]);
    ck_assert_int_eq(result, 0);
  }
  ck_assert_int_eq(s21_round(dec_res, NULL), 1);
}
END_TEST

START_TEST(test_s21_sub) {
  printf("test_s21_sub\n");
  s21_decimal dec_num_1[] = {
      {{10, 0, 0, 0}},
      {{10, 0, 0, 0x80000000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0x80000000}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0x80000000}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0x80000000}},
      {{16, 0, 0, 0x10000}},
      {{16, 0, 0, 0x80010000}},
      {{1, 0, 0, 0}},
      {{2, 0, 0, 0x80000000}},
  };

  s21_decimal dec_num_2[] = {
      {{3, 0, 0, 0x80010000}},
      {{3, 0, 0, 0x10000}},
      {{6, 0, 0, 0x10000}},
      {{5, 0, 0, 0x10000}},
      {{4, 0, 0, 0x10000}},
      {{6, 0, 0, 0x80010000}},
      {{5, 0, 0, 0x80010000}},
      {{4, 0, 0, 0x80010000}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0x80000000}},
      {{0xfffffffe, 0xffffffff, 0xffffffff, 0}},
      {{1, 0, 0, 0}},
      {{2, 0, 0, 0x80000000}},
  };

  s21_decimal dec_res = {{0, 0, 0, 0}};

  char *dec_str_ans[] = {
      "000000000000000100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000001100111",
      "100000000000000100000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000001100111",
      "000000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111110",
      "000000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111110",
      "000000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111111",
      "100000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111101",
      "100000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111110",
      "100000000000000000000000000000001111111111111111111111111111111111111111"
      "11111111111111111111111111111111111111111111111111111110",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
      "000000000000000000000000000000000000000000000000000000000000000000000000"
      "00000000000000000000000000000000000000000000000000000000",
  };

  int results[] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0};
  for (size_t i = 0; i < 12; ++i) {
    int result = s21_sub(dec_num_1[i], dec_num_2[i], &dec_res);
    char dec_str[129] = {'\0'};
    s21_decimal_to_str(&dec_res, dec_str);
    printf("%d | %d\n", results[i], result);
    ck_assert_str_eq(dec_str, dec_str_ans[i]);
    ck_assert_int_eq(result, results[i]);
  }
  ck_assert_int_eq(s21_sub(dec_num_1[0], dec_num_2[0], NULL), 4);
}
END_TEST

START_TEST(test_s21_truncate) {
  printf("test_s21_truncate\n");
  s21_decimal dec_num_1[] = {
      {{1501, 0, 0, 0x30000}},
      {{1, 0, 0, 0x1c0000}},
      {{1499911188, 0, 0, 0xa0000}},
      {{1499911188, 0, 0, 0x90000}},
      {{1499911188, 0, 0, 0x80000}},
      {{1499911188, 0, 0, 0x80070000}},
      {{1499911188, 0, 0, 0x80060000}},
      {{1499911188, 0, 0, 0x80050000}},
      {{1499911188, 0, 0, 0x80040000}},
      {{1499911188, 0, 0, 0x80030000}},
      {{1499911188, 0, 0, 0x80020000}},
      {{1499911188, 0, 0, 0x80010000}},
      {{1499911188, 0, 0, 0x80000000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801c0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x801b0000}},
      {{0xffffffff, 0xffffffff, 0xffffffff, 0x80190000}},
  };

  s21_decimal dec_res = {{0, 0, 0, 0}};

  int results[] = {1,          0,     0,      1,       14,       149,
                   1499,       14999, 149991, 1499911, 14999111, 149991118,
                   1499911188, 7,     79,     7922};
  for (size_t i = 0; i < 16; ++i) {
    int result = s21_truncate(dec_num_1[i], &dec_res);
    printf("%10d | %10u | %d\n", results[i], dec_res.bits[0], result);
    ck_assert_int_eq(results[i], dec_res.bits[0]);
    ck_assert_int_eq(result, 0);
  }
  ck_assert_int_eq(s21_truncate(dec_res, NULL), 1);
}
END_TEST

int main(void) {
  Suite *s1 = suite_create("s21_decimal.h");
  TCase *tc1_1 = tcase_create("s21_decimal.h_funtions");
  SRunner *sr = srunner_create(s1);
  int nf;

  srunner_set_fork_status(sr, CK_NOFORK);
  srunner_set_log(sr, "tmp_check.log");

  suite_add_tcase(s1, tc1_1);
  tcase_add_test(tc1_1, test_s21_add);
  tcase_add_test(tc1_1, test_s21_set_exp_and_s21_get_exp);
  tcase_add_test(tc1_1, test_count_significant_bits);
  tcase_add_test(tc1_1, test_s21_mantissa_add);
  tcase_add_test(tc1_1, test_s21_mantissa_left_shift);
  tcase_add_test(tc1_1, test_s21_mantissa_right_shift);
  tcase_add_test(tc1_1, test_s21_mantissa_mul);
  tcase_add_test(tc1_1, test_s21_mantissa_sub);
  tcase_add_test(tc1_1, test_s21_mantissa_div);
  tcase_add_test(tc1_1, test_s21_set_mantissa);
  tcase_add_test(tc1_1, test_s21_div);
  tcase_add_test(tc1_1, test_s21_floor);
  tcase_add_test(tc1_1, test_s21_from_decimal_to_float);
  tcase_add_test(tc1_1, test_s21_from_decimal_to_int);
  tcase_add_test(tc1_1, test_s21_from_float_to_decimal);
  tcase_add_test(tc1_1, test_s21_from_int_to_decimal);
  tcase_add_test(tc1_1, test_s21_is_equal);
  tcase_add_test(tc1_1, test_s21_is_greater);
  tcase_add_test(tc1_1, test_s21_is_greater_or_equal);
  tcase_add_test(tc1_1, test_s21_is_less);
  tcase_add_test(tc1_1, test_s21_is_less_or_equal);
  tcase_add_test(tc1_1, test_s21_is_not_equal);
  tcase_add_test(tc1_1, test_s21_mul);
  tcase_add_test(tc1_1, test_s21_array_div);
  tcase_add_test(tc1_1, test_s21_negate);
  tcase_add_test(tc1_1, test_s21_normalize);
  tcase_add_test(tc1_1, test_s21_round);
  tcase_add_test(tc1_1, test_s21_sub);
  tcase_add_test(tc1_1, test_s21_truncate);

  srunner_run_all(sr, CK_ENV);
  nf = srunner_ntests_failed(sr);
  srunner_free(sr);

  return nf == 0 ? 0 : 1;
}
